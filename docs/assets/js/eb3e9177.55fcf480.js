"use strict";(self.webpackChunkliveviewjs_com=self.webpackChunkliveviewjs_com||[]).push([[653],{876:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>u});var o=n(2784);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=o.createContext({}),p=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),u=i,m=d["".concat(s,".").concat(u)]||d[u]||h[u]||r;return n?o.createElement(m,a(a({ref:t},c),{},{components:n})):o.createElement(m,a({ref:t},c))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,a=new Array(r);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,a[1]=l;for(var p=2;p<r;p++)a[p]=n[p];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5119:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var o=n(7896),i=(n(2784),n(876));const r={sidebar_position:2},a='"Hooks" (not the React kind)',l={unversionedId:"client-javascript/client-hooks",id:"client-javascript/client-hooks",title:'"Hooks" (not the React kind)',description:'Sometimes you need to do something that is not supported by any of the existing user event bindings or that requires hooking into a client-side DOM event. LiveView has "Hooks" for these types of situations.',source:"@site/docs/10-client-javascript/client-hooks.md",sourceDirName:"10-client-javascript",slug:"/client-javascript/client-hooks",permalink:"/liveviewjs/docs/client-javascript/client-hooks",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Client-side Javascript",permalink:"/liveviewjs/docs/client-javascript/overview"},next:{title:"Example Hook",permalink:"/liveviewjs/docs/client-javascript/example-hook"}},s={},p=[{value:"<code>phx-hook</code> Attribute",id:"phx-hook-attribute",level:2},{value:"Registering Hooks",id:"registering-hooks",level:2},{value:"Hook Lifecycle",id:"hook-lifecycle",level:2},{value:"Hook Context",id:"hook-context",level:2}],c={toc:p};function h(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"hooks-not-the-react-kind"},'"Hooks" (not the React kind)'),(0,i.kt)("p",null,'Sometimes you need to do something that is not supported by any of the existing user event bindings or that requires hooking into a client-side DOM event. LiveView has "Hooks" for these types of situations.  '),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},'  The term "Hooks" comes from Phoenix/LiveView which this project is based on and whose client library we are utilizing. LiveView "Hooks" are in no way related to React "Hooks". It is unfortunate that "Hooks" is overloaded but we don\'t find it very confusing considering how different LiveView is from React.')),(0,i.kt)("h2",{id:"phx-hook-attribute"},(0,i.kt)("inlineCode",{parentName:"h2"},"phx-hook")," Attribute"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"phx-hook"),' attribute is used to attach a LiveView "Hook" to a DOM element.  The value of the attribute is the name of the hook (which must be registered in the client-side ',(0,i.kt)("inlineCode",{parentName:"p"},"LiveSocket"),").  For example, if you wanted to attach a hook named ",(0,i.kt)("inlineCode",{parentName:"p"},"MyHook")," to a button, you would do the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<button phx-hook="MyHook">Click Me</button>\n')),(0,i.kt)("h2",{id:"registering-hooks"},"Registering Hooks"),(0,i.kt)("p",null,"As noted above, you must register the hook in the client-side ",(0,i.kt)("inlineCode",{parentName:"p"},"LiveSocket")," before you can use it.  You do this by first defining the hook and then by adding the hook to the ",(0,i.kt)("inlineCode",{parentName:"p"},"hooks")," option when you create the ",(0,i.kt)("inlineCode",{parentName:"p"},"LiveSocket"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'// Define the hook\nconst Hooks = {\n  MyHook: {\n    mounted() {\n      // do something when the element is mounted\n      console.log("MyHook mounted");\n    }\n  }\n}\n...\n// Add the hook to the LiveSocket\nlet liveSocket = new LiveSocket("/live", Socket, {\n  hooks: { MyHook }\n});\n...\n')),(0,i.kt)("p",null,"This hook will simply print a message to the console when the element is mounted. "),(0,i.kt)("h2",{id:"hook-lifecycle"},"Hook Lifecycle"),(0,i.kt)("p",null,"Hooks have the following lifecycle methods:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mounted")," - the element has been added to the DOM and its server LiveView has finished mounting"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"beforeUpdate")," - the element is about to be updated in the DOM. Note: any call here must be synchronous as the operation cannot be deferred or cancelled."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"updated")," - the element has been updated in the DOM by the server"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"destroyed")," - the element has been removed from the page, either by a parent update, or by the parent being removed entirely"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"disconnected")," - the element's parent LiveView has disconnected from the server"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"reconnected")," - the element's parent LiveView has reconnected to the server")),(0,i.kt)("h2",{id:"hook-context"},"Hook Context"),(0,i.kt)("p",null,"Inside the hook lifecycle methods you can reference many additional properties and methods for the hook including:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"el")," - attribute referencing the bound DOM node\nliveSocket - the reference to the underlying LiveSocket instance"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pushEvent(event, payload, (reply, ref) => ...)")," - method to push an event from the client to the LiveView server"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pushEventTo(selectorOrTarget, event, payload, (reply, ref) => ...)")," - method to push targeted events from the client to LiveViews and LiveComponents. It sends the event to the LiveComponent or LiveView the selectorOrTarget is defined in, where its value can be either a query selector or an actual DOM element. If the query selector returns more than one element it will send the event to all of them, even if all the elements are in the same LiveComponent or LiveView."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"handleEvent(event, (payload) => ...)")," - method to handle an event pushed from the server"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"upload(name, files)")," - method to inject a list of file-like objects into an uploader."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"uploadTo(selectorOrTarget, name, files)")," - method to inject a list of file-like objects into an uploader. The hook will send the files to the uploader with name defined by allow_upload/3 on the server-side. Dispatching new uploads triggers an input change event which will be sent to the LiveComponent or LiveView the selectorOrTarget is defined in, where its value can be either a query selector or an actual DOM element. If the query selector returns more than one live file input, an error will be logged.")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"  The ",(0,i.kt)("inlineCode",{parentName:"p"},"@types/phoenix_live_view")," package provides a (currently incomplete) type definition for a hook.  You can use it by importing the ",(0,i.kt)("inlineCode",{parentName:"p"},"ViewHook")," type from the ",(0,i.kt)("inlineCode",{parentName:"p"},"phoenix_live_view")," package."),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import { ViewHook } from "phoenix_live_view";\n'))))}h.isMDXComponent=!0}}]);